function setupAutocomplete(inputId, suggestionsId) {
    const input = document.getElementById(inputId);
    const suggestions = document.getElementById(suggestionsId);

    input.addEventListener('input', function () {
        const query = input.value.trim();

        if (query.length < 2) {
            suggestions.innerHTML = '';
            return;
        }

        // API-url'er til vejnavne og stednavne
        const vejnavneUrl = `https://api.dataforsyningen.dk/vejstykker/autocomplete?q=${query}&type=vejnavn`;
        const stednavneUrl = `https://api.dataforsyningen.dk/stednavne/autocomplete?q=${query}`;

        Promise.all([
            fetch(vejnavneUrl).then(response => response.json()),
            fetch(stednavneUrl).then(response => response.json())
        ]).then(([vejnavne, stednavne]) => {
            const combinedResults = [...vejnavne, ...stednavne]; // Kombiner resultaterne
            suggestions.innerHTML = '';

            if (combinedResults.length === 0) {
                const noResults = document.createElement('div');
                noResults.textContent = 'Ingen resultater fundet';
                noResults.style.color = 'red';
                suggestions.appendChild(noResults);
                return;
            }

            combinedResults.forEach(item => {
                const suggestion = document.createElement("div");
                suggestion.textContent = item.tekst;
                suggestion.addEventListener('click', function () {
                    input.value = item.tekst;
                    suggestions.innerHTML = '';

                    if (item.adgangsadresse) {
                        // Håndter vejnavne
                        fetch(`https://api.dataforsyningen.dk/adgangsadresser/${item.adgangsadresse.id}`)
                            .then(res => res.json())
                            .then(addressData => {
                                if (addressData.adgangspunkt && addressData.adgangspunkt.koordinater) {
                                    placeMarkerAndZoom(addressData.adgangspunkt.koordinater, item.tekst);
                                } else {
                                    console.error("Ingen koordinater tilgængelige for adressen:", item);
                                }
                            });
                    } else {
                        // Håndter stednavne korrekt
                        fetch(`https://api.dataforsyningen.dk/stednavne?navn=${encodeURIComponent(item.tekst)}`)
                            .then(res => res.json())
                            .then(stedData => {
                                if (stedData.length > 0 && stedData[0].visueltcenter && stedData[0].visueltcenter.coordinates) {
                                    let [lon, lat] = stedData[0].visueltcenter.coordinates;
                                    console.log("Stednavn koordinater:", lon, lat);
                                    placeMarkerAndZoom([lat, lon], item.tekst); // Lat/lon byttet pga. API format
                                } else {
                                    console.error("Ingen koordinater tilgængelige for stednavnet:", item);
                                }
                            });
                    }
                });
                suggestions.appendChild(suggestion);
            });
        }).catch(err => console.error('Fejl i autocomplete:', err));
    });

    document.addEventListener('click', function (e) {
        if (!suggestions.contains(e.target) && e.target !== input) {
            suggestions.innerHTML = '';
        }
    });
}
